@model aspnetmvcjson.Models.Article

@Styles.Render("~/Content/css")

@if (ViewBag.ArticleEdited != null)
{
    <script type='text/javascript'>parent.ArticleEdited();</script>
}
else
{

    using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()<div class="container-fluid">

            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            @Html.HiddenFor(model => model.id)

            <div class="row">

                <div class="col-sm-4">
                    @Html.LabelFor(model => model.articletitle, htmlAttributes: new { @class = "control-label col-md-2" })
                </div>
                <div class="col-sm-8">
                    @Html.TextBoxFor(model => model.articletitle, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.articletitle, "", new { @class = "text-danger" })
                </div>

            </div>

            <div class="row">

                <div class="col-sm-12">
                    &nbsp;
                </div>

            </div>

            <div class="row">

                <div class="col-sm-4">
                    @Html.LabelFor(model => model.articleauthor, htmlAttributes: new { @class = "control-label col-md-2" })
                </div>
                <div class="col-sm-8">
                    @Html.TextBoxFor(model => model.articleauthor, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.articleauthor, "", new { @class = "text-danger" })
                </div>

            </div>

            <div class="row">

                <div class="col-sm-12">
                    &nbsp;
                </div>

            </div>

            <div class="row">

                <div class="col-sm-4">
                    @Html.LabelFor(model => model.articlebody, htmlAttributes: new { @class = "control-label col-md-2" })
                </div>
                <div class="col-sm-8">
                    @Html.TextAreaFor(model => model.articlebody, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.articlebody, "", new { @class = "text-danger" })
                </div>

            </div>

            <div class="row">

                <div class="col-sm-12">
                    &nbsp;
                </div>

            </div>

            <div class="row">

                <div class="col-sm-4">
                    Article Image
                </div>
                <div class="col-sm-8">
                    <input type="file" id="fileArticleImage" class="form-control" style="width: 99%" />
                    <img id="imagArticlePreview" src="@Model.articleimage" class="img-fluid" style="max-width: 200px; margin-top: 5px" />
                    @Html.HiddenFor(model => model.articleimage, new { @id = "hdnarticleimage" })
                    <script type="text/javascript">
                        function readFile() {

                            document.querySelector("#imagArticlePreview").src = "";

                            if (!this.files || !this.files[0]) return;

                            const FR = new FileReader();

                            FR.addEventListener("load", function (evt) {
                                document.querySelector("#hdnarticleimage").value = evt.target.result;
                                document.querySelector("#imagArticlePreview").src = evt.target.result;
                                //document.querySelector("#b64").textContent = evt.target.result;
                            });

                            FR.readAsDataURL(this.files[0]);

                        }

                        document.querySelector("#fileArticleImage").addEventListener("change", readFile);
                    </script>
                </div>

            </div>

            <div class="row">

                <div class="col-sm-12">
                    &nbsp;
                </div>

            </div>

            <div class="row">

                <div class="col-sm-12 text-center">
                    <input type="submit" value="Edit" class="btn btn-danger" />
                </div>

            </div>


            <div class="row">

                <div class="col-sm-12">
                    &nbsp;
                </div>

            </div>

        </div>
    }

    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
    }
}